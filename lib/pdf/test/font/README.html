<h1 id="Font-tests"><a href="#Font-tests" class="headerlink" title="Font tests"></a>Font tests</h1><p>The font tests check if PDF.js can read font data correctly. For validation<br>the <code>ttx</code> tool (from the Python <code>fonttools</code> library) is used that can convert<br>font data to an XML format that we can easily use for assertions in the tests.<br>In the font tests we let PDF.js read font data and pass the PDF.js-interpreted<br>font data through <code>ttx</code> to check its correctness. The font tests are successful<br>if PDF.js can successfully read the font data and <code>ttx</code> can successfully read<br>the PDF.js-interpreted font data back, proving that PDF.js does not apply any<br>transformations that break the font data.</p>
<h2 id="Running-the-font-tests"><a href="#Running-the-font-tests" class="headerlink" title="Running the font tests"></a>Running the font tests</h2><p>The font tests are run on GitHub Actions using the workflow defined in<br><code>.github/workflows/font_tests.yml</code>, but it is also possible to run the font<br>tests locally. The current stable versions of the following dependencies are<br>required to be installed on the system:</p>
<ul>
<li>Python 3</li>
<li><code>fonttools</code> (see <a href="https://pypi.org/project/fonttools">https://pypi.org/project/fonttools</a> and <a href="https://github.com/fonttools/fonttools">https://github.com/fonttools/fonttools</a>)</li>
</ul>
<p>The recommended way of installing <code>fonttools</code> is using <code>pip</code> in a virtual<br>environment because it avoids having to do a system-wide installation and<br>therefore improves isolation, but any other way of installing <code>fonttools</code><br>that makes <code>ttx</code> available in the <code>PATH</code> environment variable also works.</p>
<p>Using the virtual environment approach the font tests can be run locally by<br>creating and sourcing a virtual environment with <code>fonttools</code> installed in<br>it before running the font tests:</p>
<pre><code>python3 -m venv venv
source venv/bin/activate
pip install fonttools
npx gulp fonttest
</code></pre>
